This code was written by Max Tamer-Mahoney. Use it wisely.